---
layout: post
title: Using Keyboard Maestro to Create an Always Up to Date Task Calendar from My OmniFocus
last_modified_at: 2021-10-10 00:00:00 +00:00
date: 2018-09-25 12:49:01.000000000 +01:00
type: post
published: true
tags:
redirect_from:
  - /blog/2018/09/25/using-keyboard-maestro-to-create-an-always-up-to-date-task-calendar-from-my-omnifocus
  - /blog/2018/09/25/using-keyboard-maestro-to-create-an-always-up-to-date-task-calendar-from-my-omnifocus.html
---

<p>
  OmniFocus 2 had a calendar you could subscribe to, which gave you a calendar
  view of your tasks. Unfortunately just because of internet connections and
  syncing times which was always a little flakey (completed tasks would hang
  around for a while) and didn't have all of the options I wanted. Unfortunately
  very few people used this service so it was discontinued in OmniFocus 3 - but
  I have an alternative!
</p>
<!--more-->
<p>
  Someone in the OmniFocus Slack pointed me to
  <a
    href="https://discourse.omnigroup.com/t/applescript-for-syncing-of-tasks-to-apple-calendar/32054/3at calendar_element
                    end if
             end tell
           end tell
       end repeat
 end tell
end tell
</code></pre>
<p>
  To summarise: Every incomplete task with a due date is added to the calendar.
</p>
<ul>
  <li>The name of the task becomes the name of the event.</li>
  <li>The task note becomes the event note</li>
  <li>
    If the task has an estimated duration this is used, otherwise the event is
    set to whatever the default_duration property is at the top of the list (30
    minutes in this example)
  </li>
  <li>
    The due date and the duration of the event are used to calculate the start
    date
  </li>
  <li>The URL of the event is set to be a URL back to the task</li>
</ul>
<p>
  <img
    src="{{ "/assets/2018/09/DCCD14E2-E31B-455C-9702-0CB245100C88.png" | absolute_url }}"
    alt="Graphical view of the Keyboard Maestro Macro"
  />
</p>
<p>
  I don't use the calendar much myself (preferring Fantastical) so I also have
  Keyboard Maestro quit the calendar afterwards for me.
</p>
<p>
  This Macro uses the cron timer in Keyboard Maestro to run hourly, I've added
  it to a specific group so it only runs on one of my Macs too. When you
  download it you will need to enable it, first make sure you create an
  OmniFocus calendar though, and if you give this calendar a different name then
  you'll need to update the Macro too.
</p>
<p>
  This approach has several advantages over the original OmniFocus
  implementation:
</p>
<ul>
  <li>I can sync this calendar, and store it in whichever service I like.</li>
  <li>I can control the default length of events.</li>
  <li>I could choose to exclude certain events if I wished to.</li>
  <li>
    It could be a jumping off point for other scripts - such as a calendar of
    events you have completed if you wanted one of those.
  </li>
</ul>
<p>
  You could of course use other approaches to run the script automatically, or
  run it manually when you want to, it's entirely up to you!
</p>
<p>
  The script can be downloaded
  <a
    href="https://www.dropbox.com/s/kksd8xf0zo5e5fs/Auto%20Update%20OmniFocus%20Calendar.kmmacros?dl=0"
    >here</a
  >.
</p>
