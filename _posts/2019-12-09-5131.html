---
layout: post
title: ''
date: 2019-12-09 16:10:33.000000000 +00:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Everything
tags: []
meta:
  micropub_auth_response: a:10:{s:10:"token_type";s:6:"Bearer";s:5:"scope";s:34:"create
    update read follow channels";s:2:"me";s:28:"https://rosemaryorchard.com/";s:9:"issued_by";s:55:"https://rosemaryorchard.com/wp-json/indieauth/1.0/token";s:9:"client_id";s:23:"https://monocle.p3k.io/";s:11:"client_name";s:7:"Monocle";s:11:"client_icon";s:34:"https://monocle.p3k.io/favicon.ico";s:9:"issued_at";i:1575652777;s:4:"user";i:1;s:13:"last_accessed";i:1575904233;}
  mf2_type: a:1:{i:0;s:7:"h-entry";}
  mf2_in-reply-to: "a:1:{i:0;a:2:{s:4:\"type\";a:1:{i:0;s:6:\"h-cite\";}s:10:\"properties\";a:13:{s:3:\"uid\";a:1:{i:0;i:5119;}s:11:\"post_author\";a:1:{i:0;s:1:\"1\";}s:9:\"post_type\";a:1:{i:0;s:4:\"post\";}s:6:\"author\";a:2:{s:4:\"type\";a:1:{i:0;s:6:\"h-card\";}s:10:\"properties\";a:3:{s:4:\"name\";a:1:{i:0;s:16:\"Rosemary
    Orchard\";}s:3:\"url\";a:1:{i:0;s:28:\"https://rosemaryorchard.com/\";}s:5:\"photo\";a:1:{i:0;s:84:\"https://secure.gravatar.com/avatar/6454cee1467de5a12ea9f1c91d48e100?s=96&d=retro&r=g\";}}}s:11:\"publication\";a:1:{i:0;s:16:\"Rosemary
    Orchard\";}s:9:\"published\";a:1:{i:0;s:25:\"2019-12-08T21:51:56+01:00\";}s:7:\"updated\";a:1:{i:0;s:25:\"2019-12-09T00:25:22+01:00\";}s:7:\"content\";a:1:{i:0;a:2:{s:4:\"html\";s:2458:\"As
    is often the case, as I use Drafts I find things that I need to do and write a
    script to fix it for me! In this case, I have a habit of planning to add links
    later in my text, but find it a pain to go through the whole article to find them
    and the find function is too darn <em>manual</em> for me. There were already a
    few actions in the Actions Directory, but they didn't quite work the way I wanted
    them to. If you haven't guessed where this is going yet: I wrote my own!\r\n\r\nThis
    action using the Script function in Drafts, and some good old <a href=\"https://www.relay.fm/automators/34\">regular
    expressions</a>. The code itself can be broken down into eight steps:\r\n\r\n<ol>\r\n
    \   <li>Get the contents of the Draft.</li>\r\n    <li>Create the regular expression.</li>\r\n
    \   <li>Parse the contents of the Draft with the regular expression to get a list
    of <code>matches</code></li>\r\n    <li>Create a prompt</li>\r\n    <li>Add each
    match to the prompt</li>\r\n    <li>Show the prompt</li>\r\n    <li>Go through
    each match again and replace it (within the whole content) with the information
    provided through the prompt.</li>\r\n    <li>Update the draft.</li>\r\n</ol>\r\n\r\n<pre><code
    class=\"language-javascript\">let content = draft.content; //get the content of
    the draft\r\n\r\nlet pattern = /[[^]]+]()/g; //build the regex\r\n\r\nlet matches
    = content.match(pattern); //find all the empty links\r\n\r\n//create the prompt\r\nlet
    p = Prompt.create();\r\np.title = \"Missing Links\";\r\n\r\n//add each empty link
    to the prompt\r\nmatches.forEach(function (match, index){\r\n    p.addTextField(index,
    match.replace('[', '').replace(']()', ''), \"\");\r\n});\r\n\r\n//show the prompt\r\np.addButton(\"OK\");\r\nlet
    didSelect = p.show();\r\n\r\n//if the prompt wasn't cancelled\r\nif (didSelect)
    {\r\n    if (p.buttonPressed == \"OK\") {\r\n        //go through each empty link
    and replace it with the updated information\r\n        Object.keys(p.fieldValues).forEach(function
    (index) {\r\n            content = content.replace(matches[index], matches[index].replace('()',
    '('+p.fieldValues[index]+')'))\r\n        });\r\n    }\r\n}\r\n\r\n//update the
    draft\r\ndraft.content = content;\r\ndraft.update();</code></pre>\r\n\r\n&nbsp;\r\n\r\nThe
    idea is I can run this at the end of writing, deal with all my links in one prompt,
    and get on with things. It's the kind of action I'll include as a step in other
    actions to make sure I don't accidentally post empty links!\r\n\r\n<a href=\"https://actions.getdrafts.com/a/11o\">Get
    it from the action directory</a>\";s:5:\"value\";s:2204:\"As is often the case,
    as I use Drafts I find things that I need to do and write a script to fix it for
    me! In this case, I have a habit of planning to add links later in my text, but
    find it a pain to go through the whole article to find them and the find function
    is too darn manual for me. There were already a few actions in the Actions Directory,
    but they didn't quite work the way I wanted them to. If you haven't guessed where
    this is going yet: I wrote my own!\r\n\r\nThis action using the Script function
    in Drafts, and some good old regular expressions. The code itself can be broken
    down into eight steps:\r\n\r\n\r\n    Get the contents of the Draft.\r\n    Create
    the regular expression.\r\n    Parse the contents of the Draft with the regular
    expression to get a list of matches\r\n    Create a prompt\r\n    Add each match
    to the prompt\r\n    Show the prompt\r\n    Go through each match again and replace
    it (within the whole content) with the information provided through the prompt.\r\n
    \   Update the draft.\r\n\r\n\r\nlet content = draft.content; //get the content
    of the draft\r\n\r\nlet pattern = /[[^]]+]()/g; //build the regex\r\n\r\nlet matches
    = content.match(pattern); //find all the empty links\r\n\r\n//create the prompt\r\nlet
    p = Prompt.create();\r\np.title = \"Missing Links\";\r\n\r\n//add each empty link
    to the prompt\r\nmatches.forEach(function (match, index){\r\n    p.addTextField(index,
    match.replace('[', '').replace(']()', ''), \"\");\r\n});\r\n\r\n//show the prompt\r\np.addButton(\"OK\");\r\nlet
    didSelect = p.show();\r\n\r\n//if the prompt wasn't cancelled\r\nif (didSelect)
    {\r\n    if (p.buttonPressed == \"OK\") {\r\n        //go through each empty link
    and replace it with the updated information\r\n        Object.keys(p.fieldValues).forEach(function
    (index) {\r\n            content = content.replace(matches[index], matches[index].replace('()',
    '('+p.fieldValues[index]+')'))\r\n        });\r\n    }\r\n}\r\n\r\n//update the
    draft\r\ndraft.content = content;\r\ndraft.update();\r\n\r\n&nbsp;\r\n\r\nThe
    idea is I can run this at the end of writing, deal with all my links in one prompt,
    and get on with things. It's the kind of action I'll include as a step in other
    actions to make sure I don't accidentally post empty links!\r\n\r\nGet it from
    the action directory\";}}s:4:\"kind\";a:1:{i:0;s:7:\"article\";}s:3:\"url\";a:1:{i:0;s:72:\"https://rosemaryorchard.com/blog/drafts-action-fix-empty-markdown-links/\";}s:4:\"name\";a:1:{i:0;s:39:\"Drafts
    Action: Fix Empty Markdown Links\";}s:8:\"category\";a:2:{i:0;s:10:\"Automation\";i:1;s:6:\"Drafts\";}s:8:\"featured\";a:1:{i:0;s:84:\"https://rosemaryorchard.com/wp-content/uploads/2019/05/Drafts-Capture-‣‣-Act.png\";}}}}"
  mf2_content: a:1:{i:0;s:130:"I presume you do something like `[this]` for a link
    and miss the `()`? I'm sure I could extend the action to work with that too ;)";}
  mf2_syndication: a:1:{i:0;s:42:"https://micro.blog/rosemaryorchard/7131411";}
author:
  login: rosemaryorchard
  email: me@rosemaryorchard.com
  display_name: Rosemary Orchard
  first_name: Rosemary
  last_name: Orchard
permalink: "/everything/5131/"
---
<p>I presume you do something like `[this]` for a link and miss the `()`? I'm sure I could extend the action to work with that too ;)</p>
